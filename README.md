# JM漫画下载与发送插件

这是一个AstrBot插件，用于下载JM漫画并以合并转发消息形式发送图片。

## 功能

- 支持下载整本漫画（`/jms <漫画ID>`）
- 支持下载指定章节（`/jmsp <漫画ID> <章节ID>`）
- 支持以合并转发形式发送图片，提供更好的浏览体验
- 支持私聊和群聊使用
- 支持多平台适配（webchat使用普通图片发送，QQ等平台使用合并转发）
- 每日自动清理下载文件，避免占用过多存储空间（每天凌晨3点自动执行）
- 支持手动清理下载文件（`/jmclean`）

## 安装方法

1. 确保已安装AstrBot
2. 将本插件复制到`data/plugins/`目录下
3. 安装依赖：`pip install -r requirements.txt`
4. 在option.yml中配置代理（如需）
5. 重启机器人

## 使用方法

### 基本命令

```
/jms <漫画ID>   - 下载并发送整本漫画的所有图片
/jmsp <漫画ID> <章节ID>  - 下载并发送指定章节的所有图片
/jmclean        - 手动清理所有下载的漫画文件
```

### 配置说明

本插件使用了`jmcomic`库，配置文件为`option.yml`，可以根据需要修改。

## 注意事项

1. 下载速度取决于网络状况和代理设置
2. 默认使用Chrome浏览器的Cookie，请确保已登录JM网站
3. 本插件分批次发送图片，每批最多10张，以避免消息过大
4. 在私聊和群聊中均使用合并转发消息发送，如果合并转发失败会自动降级为普通消息发送

## 相关配置

在`option.yml`中可以修改以下配置：

- 下载目录：`dir_rule.base_dir`
- 代理设置：`client.postman.meta_data.proxies`
- 线程数：`download.threading`

## 许可证

MIT 